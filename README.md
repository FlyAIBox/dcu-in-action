# æµ·å…‰DCUåŠ é€Ÿå¡å®æˆ˜æŒ‡å—

<div align="center">

![DCU Logo](https://img.shields.io/badge/æµ·å…‰DCU-åŠ é€Ÿè®¡ç®—-blue.svg)
![Python](https://img.shields.io/badge/Python-3.8+-green.svg)
![PyTorch](https://img.shields.io/badge/PyTorch-2.0+-red.svg)
![License](https://img.shields.io/badge/License-Apache%202.0-orange.svg)

**åŸºäºæµ·å…‰DCUåŠ é€Ÿå¡çš„å¤§æ¨¡å‹è®­ç»ƒã€å¾®è°ƒã€æ¨ç†ä¸HPCç§‘å­¦è®¡ç®—å®æˆ˜æ•™ç¨‹**

</div>

---

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå…¨é¢çš„æµ·å…‰DCUï¼ˆData Compute Unitï¼‰åŠ é€Ÿå¡å®æˆ˜æŒ‡å—ï¼Œä¸“æ³¨äºäººå·¥æ™ºèƒ½å’Œé«˜æ€§èƒ½è®¡ç®—é¢†åŸŸçš„å®é™…åº”ç”¨ã€‚æ¶µç›–ä»ç¯å¢ƒé…ç½®åˆ°ç”Ÿäº§éƒ¨ç½²çš„å®Œæ•´æµç¨‹ï¼Œä¸ºæµ·å…‰DCUç”¨æˆ·å’Œå¤§æ¨¡å‹æŠ€æœ¯çˆ±å¥½è€…æä¾›è¯¦ç»†çš„æŠ€æœ¯æ–‡æ¡£å’Œä¸°å¯Œçš„ä»£ç ç¤ºä¾‹ã€‚

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- **ğŸš€ å¤§æ¨¡å‹è®­ç»ƒ**ï¼šæ”¯æŒLLaMAã€ChatGLMã€Qwenç­‰ä¸»æµå¤§æ¨¡å‹çš„ä»é›¶è®­ç»ƒ
- **ğŸ¨ æ¨¡å‹å¾®è°ƒ**ï¼šæä¾›LoRAã€QLoRAã€P-Tuningç­‰é«˜æ•ˆå¾®è°ƒæ–¹æ¡ˆ
- **âš¡ æ¨ç†åŠ é€Ÿ**ï¼šé›†æˆvLLMã€TensorRTç­‰æ¨ç†ä¼˜åŒ–å¼•æ“
- **ğŸ”¬ HPCè®¡ç®—**ï¼šç§‘å­¦è®¡ç®—ã€æ•°å€¼åˆ†æã€å¹¶è¡Œè®¡ç®—ç¤ºä¾‹
- **ğŸ“Š æ€§èƒ½ç›‘æ§**ï¼šå®Œæ•´çš„æ€§èƒ½åˆ†æå’Œä¼˜åŒ–å·¥å…·é“¾
- **ğŸ› ï¸ å¼€å‘å·¥å…·**ï¼šä¾¿æ·çš„å¼€å‘ç¯å¢ƒé…ç½®å’Œè°ƒè¯•å·¥å…·

### ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```mermaid
graph TB
    A[æµ·å…‰DCUç¡¬ä»¶å¹³å°] --> B[DTKè¿è¡Œæ—¶ç¯å¢ƒ]
    B --> C[æ·±åº¦å­¦ä¹ æ¡†æ¶]
    C --> D[PyTorch + ROCM]
    C --> E[PaddlePaddle]
    C --> F[TensorFlow]
    D --> G[å¤§æ¨¡å‹åº”ç”¨]
    G --> H[æ¨¡å‹è®­ç»ƒ]
    G --> I[æ¨¡å‹å¾®è°ƒ]
    G --> J[æ¨¡å‹æ¨ç†]
    G --> K[HPCè®¡ç®—]
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
dcu-in-action/
â”œâ”€â”€ docs/                          # ğŸ“š è¯¦ç»†æ–‡æ¡£
â”‚   â”œâ”€â”€ 01-dcu-installation.md     # DCUç¯å¢ƒå®‰è£…æŒ‡å—
â”‚   â”œâ”€â”€ 02-llm-inference.md        # å¤§æ¨¡å‹æ¨ç†æ•™ç¨‹
â”‚   â”œâ”€â”€ 03-llm-fine-tuning.md      # å¤§æ¨¡å‹å¾®è°ƒæ•™ç¨‹
â”‚   â”œâ”€â”€ 04-llm-training.md         # å¤§æ¨¡å‹è®­ç»ƒæ•™ç¨‹
â”‚   â”œâ”€â”€ 05-llm-for-science.md      # ç§‘å­¦è®¡ç®—åº”ç”¨æ•™ç¨‹
â”‚   â””â”€â”€ dcu/                       # DCUä¸“ç”¨æ–‡æ¡£
â”œâ”€â”€ examples/                      # ğŸ¯ ç¤ºä¾‹ä»£ç 
â”‚   â”œâ”€â”€ llm-training/              # å¤§æ¨¡å‹è®­ç»ƒç¤ºä¾‹
â”‚   â”œâ”€â”€ llm-fine-tuning/           # å¤§æ¨¡å‹å¾®è°ƒç¤ºä¾‹
â”‚   â”œâ”€â”€ llm-inference/             # å¤§æ¨¡å‹æ¨ç†ç¤ºä¾‹
â”‚   â””â”€â”€ llm-for-science/           # ç§‘å­¦è®¡ç®—ç¤ºä¾‹
â”œâ”€â”€ scripts/                       # ğŸ”§ å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ setup/                     # ç¯å¢ƒé…ç½®è„šæœ¬
â”‚   â””â”€â”€ utils/                     # å®ç”¨å·¥å…·è„šæœ¬
â””â”€â”€ README.md                      # ğŸ“– é¡¹ç›®è¯´æ˜
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

#### ç¡¬ä»¶è¦æ±‚
- **DCUè®¾å¤‡**ï¼šæµ·å…‰DCU Z100/K100/K100-AIç³»åˆ—
- **CPU**ï¼šæ”¯æŒæµ·å…‰æˆ–å…¼å®¹x86æ¶æ„
- **å†…å­˜**ï¼šå»ºè®®32GBä»¥ä¸Š
- **å­˜å‚¨**ï¼šSSD 500GBä»¥ä¸Š

#### è½¯ä»¶è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**ï¼šUOS 20/ç»Ÿä¿¡UOS/CentOS 7.8+/Ubuntu 20.04+
- **Python**ï¼š3.8+ (æ¨è3.10)
- **DTK**ï¼š24.04.3+ (æµ·å…‰DCUå¼€å‘å·¥å…·åŒ…)
- **Docker**ï¼š20.10+ (å¯é€‰)

### 2. å®‰è£…DCUç¯å¢ƒ

```bash
# æ–¹æ³•ä¸€ï¼šä½¿ç”¨å®˜æ–¹é•œåƒï¼ˆæ¨èï¼‰
docker pull image.sourcefind.cn:5000/dcu/admin/base/pytorch:2.4.1-ubuntu22.04-dtk25.04-py3.10

# æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å®‰è£…DTK
# è¯·å‚è€ƒ docs/01-dcu-installation.md è¯¦ç»†æ•™ç¨‹
```

### 3. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/your-repo/dcu-in-action.git
cd dcu-in-action
```

### 4. éªŒè¯å®‰è£…

```bash
# è¿è¡Œç¯å¢ƒæ£€æŸ¥è„šæœ¬
bash scripts/setup/check_environment.sh

# è¿è¡Œç®€å•æµ‹è¯•
python examples/llm-inference/simple_test.py
```

---

## ğŸ“š åº”ç”¨åœºæ™¯ä¸ç¤ºä¾‹

### ğŸ¯ å¤§æ¨¡å‹è®­ç»ƒ
- **é¢„è®­ç»ƒ**ï¼šä»é›¶å¼€å§‹è®­ç»ƒå¤§è¯­è¨€æ¨¡å‹
- **ç»§ç»­è®­ç»ƒ**ï¼šåœ¨ç°æœ‰æ¨¡å‹åŸºç¡€ä¸Šç»§ç»­è®­ç»ƒ
- **åˆ†å¸ƒå¼è®­ç»ƒ**ï¼šå¤šå¡å¤šæœºè®­ç»ƒåŠ é€Ÿ

```bash
# è¿è¡ŒLLaMA-7Bè®­ç»ƒç¤ºä¾‹
cd examples/llm-training
python train_llama.py --config configs/llama_7b.yaml
```

### ğŸ¨ æ¨¡å‹å¾®è°ƒ
- **LoRAå¾®è°ƒ**ï¼šå‚æ•°é«˜æ•ˆå¾®è°ƒæ–¹æ³•
- **å…¨é‡å¾®è°ƒ**ï¼šå®Œæ•´å‚æ•°å¾®è°ƒ
- **æŒ‡ä»¤å¾®è°ƒ**ï¼šé’ˆå¯¹ç‰¹å®šä»»åŠ¡çš„å¾®è°ƒ

```bash
# è¿è¡ŒChatGLM-6B LoRAå¾®è°ƒ
cd examples/llm-fine-tuning
python finetune_chatglm.py --model chatglm2-6b --method lora
```

### âš¡ æ¨¡å‹æ¨ç†
- **å•å¡æ¨ç†**ï¼šé«˜æ•ˆå•å¡æ¨ç†éƒ¨ç½²
- **æ‰¹é‡æ¨ç†**ï¼šå¤§æ‰¹é‡æ•°æ®å¤„ç†
- **æµå¼æ¨ç†**ï¼šå®æ—¶å¯¹è¯ç³»ç»Ÿ

```bash
# å¯åŠ¨æ¨ç†æœåŠ¡
cd examples/llm-inference
python inference_server.py --model qwen-7b --port 8000
```

### ğŸ”¬ ç§‘å­¦è®¡ç®—
- **çŸ©é˜µè¿ç®—**ï¼šå¤§è§„æ¨¡çŸ©é˜µè®¡ç®—åŠ é€Ÿ
- **æ•°å€¼æ±‚è§£**ï¼šåå¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£
- **å¹¶è¡Œè®¡ç®—**ï¼šMPI+DCUæ··åˆå¹¶è¡Œ

```bash
# è¿è¡Œç§‘å­¦è®¡ç®—ç¤ºä¾‹
cd examples/llm-for-science
python matrix_computation.py --size 10000
```

---

## ğŸ› ï¸ å¼€å‘å·¥å…·ä¸ä¼˜åŒ–

### æ€§èƒ½åˆ†æå·¥å…·
- **DCUæ€§èƒ½ç›‘æ§**ï¼šhy-smiã€rocm-smi
- **å†…å­˜åˆ†æ**ï¼šå†…å­˜ä½¿ç”¨ä¼˜åŒ–
- **è®¡ç®—åˆ†æ**ï¼šç®—å­æ€§èƒ½ä¼˜åŒ–

### è°ƒè¯•å·¥å…·
- **æ—¥å¿—ç³»ç»Ÿ**ï¼šå®Œæ•´çš„è®­ç»ƒæ—¥å¿—è®°å½•
- **å¯è§†åŒ–**ï¼šTensorBoardé›†æˆ
- **é”™è¯¯è¯Šæ–­**ï¼šå¸¸è§é—®é¢˜æ’æŸ¥

### ä¼˜åŒ–ç­–ç•¥
- **æ··åˆç²¾åº¦**ï¼šFP16/BF16è®­ç»ƒåŠ é€Ÿ
- **æ¢¯åº¦ç´¯ç§¯**ï¼šå¤§æ‰¹æ¬¡è®­ç»ƒæ”¯æŒ
- **æ£€æŸ¥ç‚¹**ï¼šè®­ç»ƒçŠ¶æ€ä¿å­˜ä¸æ¢å¤

---

## ğŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•

### è®­ç»ƒæ€§èƒ½
| æ¨¡å‹ | æ‰¹æ¬¡å¤§å° | DCUæ•°é‡ | è®­ç»ƒé€Ÿåº¦ | æ˜¾å­˜å ç”¨ |
|------|----------|---------|----------|----------|
| LLaMA-7B | 32 | 4 | 1.2K tokens/s | 28GB |
| ChatGLM2-6B | 16 | 2 | 800 tokens/s | 22GB |
| Qwen-7B | 24 | 4 | 1.1K tokens/s | 26GB |

### æ¨ç†æ€§èƒ½
| æ¨¡å‹ | ç²¾åº¦ | å»¶è¿Ÿ | ååé‡ |
|------|------|------|--------|
| ChatGLM2-6B | FP16 | 45ms | 156 tokens/s |
| Qwen-7B | FP16 | 52ms | 142 tokens/s |
| LLaMA-7B | INT8 | 38ms | 178 tokens/s |

---

## ğŸ¤ ç¤¾åŒºä¸æ”¯æŒ

### å®˜æ–¹èµ„æº
- **æµ·å…‰DCUå¼€å‘è€…ç¤¾åŒº**ï¼šhttps://developer.sourcefind.cn/
- **OpenDASé¡¹ç›®**ï¼šhttps://developer.sourcefind.cn/codes/OpenDAS
- **æŠ€æœ¯æ–‡æ¡£**ï¼šhttps://docs.hygon.cn/

### é—®é¢˜åé¦ˆ
- **Issues**ï¼šæäº¤BugæŠ¥å‘Šå’ŒåŠŸèƒ½å»ºè®®
- **è®¨è®ºåŒº**ï¼šæŠ€æœ¯äº¤æµå’Œç»éªŒåˆ†äº«
- **å¾®ä¿¡ç¾¤**ï¼šDCUç”¨æˆ·äº¤æµç¾¤

### è´¡çŒ®æŒ‡å—
æ¬¢è¿æäº¤Pull Requestæ¥å®Œå–„æœ¬é¡¹ç›®ï¼è¯·å…ˆé˜…è¯»è´¡çŒ®æŒ‡å—ï¼š
1. Forkæœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤ä»£ç å˜æ›´
4. åˆ›å»ºPull Request

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨Apache 2.0è®¸å¯è¯ - æŸ¥çœ‹[LICENSE](LICENSE)æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

---

## âš ï¸ å…è´£å£°æ˜

> **é‡è¦å£°æ˜**ï¼šæœ¬é¡¹ç›®èµ„æ–™æ¥æºäºæµ·å…‰DCUå¼€å‘ç¤¾åŒº(https://developer.sourcefind.cn/)å’Œç½‘ç»œå…¬å¼€èµ„æ–™ï¼Œä»…ç”¨äºå­¦ä¹ å’Œç ”ç©¶ç›®çš„ã€‚
> 
> - æ‰€æœ‰ä»£ç ç¤ºä¾‹å’Œæ–‡æ¡£å‡åŸºäºå…¬å¼€æŠ€æœ¯èµ„æ–™æ•´ç†
> - é¡¹ç›®å†…å®¹å¯èƒ½å­˜åœ¨æŠ€æœ¯æ›´æ–°æ»åï¼Œè¯·ä»¥å®˜æ–¹æœ€æ–°æ–‡æ¡£ä¸ºå‡†
> - ä½¿ç”¨æœ¬é¡¹ç›®è¿›è¡Œå¼€å‘æ—¶ï¼Œè¯·éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å’Œå‚å•†åè®®
> - é¡¹ç›®ç»´æŠ¤è€…ä¸å¯¹ä½¿ç”¨æœ¬é¡¹ç›®é€ æˆçš„ä»»ä½•æŸå¤±æ‰¿æ‹…è´£ä»»

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹é¡¹ç›®å’Œç¤¾åŒºçš„æ”¯æŒï¼š
- æµ·å…‰ä¿¡æ¯æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸
- æµ·å…‰DCUå¼€å‘è€…ç¤¾åŒº
- ROCmå¼€æºç¤¾åŒº
- PyTorchç¤¾åŒº
- æ‰€æœ‰è´¡çŒ®è€…å’Œç”¨æˆ·

---

<div align="center">

**ğŸŒŸ å¦‚æœæœ¬é¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªStarï¼ğŸŒŸ**

[![Star History Chart](https://api.star-history.com/svg?repos=your-repo/dcu-in-action&type=Date)](https://star-history.com/#your-repo/dcu-in-action&Date)

</div>